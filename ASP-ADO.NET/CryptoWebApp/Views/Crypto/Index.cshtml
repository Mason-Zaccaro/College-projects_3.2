@model CryptoWebApp.Models.CryptoViewModel

@{
    ViewData["Title"] = "Шифрование / Дешифрование";
}

<h2>Шифрование / Дешифрование</h2>


<form asp-action="Index" method="post">
    <div>
        <label for="Algorithm">Алгоритм:</label>
        <select asp-for="Algorithm" asp-items="ViewBag.Algorithms"></select>
    </div>

    <div>
        <input type="checkbox" id="GenerateKey" name="GenerateKey" value="true" @(Model.GenerateKey ? "checked" : "") />
        <label for="GenerateKey">Генерировать новый ключ автоматически</label>
    </div>

    <div>
        <label for="Key">Ключ (оставьте пустым, если генерируете автоматически):</label><br />
        <textarea id="Key" name="Key" rows="3" cols="60">@Model.Key</textarea>
        <p>— для AES: Base64Key:Base64IV<br />
           — для RSA: XML со всеми параметрами ключа</p>
    </div>

    <div>
        <button type="submit" name="actionType" value="encrypt">Зашифровать</button>
        <button type="submit" name="actionType" value="decrypt">Расшифровать</button>
    </div>

    @if (!string.IsNullOrEmpty(Model.ResultText))
    {
        <div style="margin-top:20px;">
            <h4>Результат:</h4>
            <textarea rows="6" cols="60" readonly>@Model.ResultText</textarea>
        </div>
    }

    @* Вывод ошибок модели *@
    @if (!ViewData.ModelState.IsValid)
    {
        <div style="color:red">
            @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
            {
                <p>@error.ErrorMessage</p>
            }
        </div>
    }
</form>
